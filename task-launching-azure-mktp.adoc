---
sidebar: sidebar 
permalink: task-launching-azure-mktp.html 
keywords: install, installation, installing, marketplace, azure, deploy, virtual machine, permissions, deploy connector in azure, install connector in azure 
summary: Azure 상용 지역의 경우 BlueXP에서 직접 커넥터를 생성하는 것이 가장 좋지만 원하는 경우 Azure Marketplace에서 Connector를 실행할 수 있습니다. Azure Government 지역의 경우 BlueXP SaaS 웹 사이트에서 정부 지역에 Connector를 배포할 수 없으므로 Azure Marketplace에서 다음 옵션을 선택하는 것이 좋습니다. 
---
= Azure Marketplace에서 Connector를 생성합니다
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
Azure 상용 지역의 경우 BlueXP에서 직접 커넥터를 생성하는 것이 가장 좋지만 원하는 경우 Azure Marketplace에서 Connector를 실행할 수 있습니다. Azure Government 지역의 경우 BlueXP SaaS 웹 사이트에서 정부 지역에 Connector를 배포할 수 없으므로 Azure Marketplace에서 다음 옵션을 선택하는 것이 좋습니다.


TIP: 네트워크 또는 클라우드의 기존 Linux 호스트에 Connector 소프트웨어를 다운로드하여 설치할 수도 있습니다. link:task-installing-linux.html["기존 Linux 호스트에 커넥터를 설치하는 방법에 대해 알아봅니다"].



== Azure에서 커넥터 만들기

Azure Marketplace의 이미지를 사용하여 Azure에서 Connector를 구축한 다음 Connector에 로그인하여 NetApp 계정을 지정합니다.

.단계
. Azure 마켓플레이스에서 NetApp Connector VM 페이지로 이동합니다.
+
** https://azuremarketplace.microsoft.com/en-us/marketplace/apps/netapp.netapp-oncommand-cloud-manager["상용 지역에 대한 Azure Marketplace 페이지"^]
** https://portal.azure.us/#create/netapp.netapp-oncommand-cloud-manageroccm-byol["Azure Government 지역의 Azure Marketplace 페이지"^]


. 지금 받기 * 를 클릭한 다음 * 계속 * 을 클릭합니다.
. Azure 포털에서 * Create * 를 클릭하고 다음 단계에 따라 가상 시스템을 구성합니다.
+
VM을 구성할 때 다음 사항에 유의하십시오.

+
** 커넥터는 HDD 또는 SSD 디스크를 사용하여 최적의 성능을 발휘할 수 있습니다.
** CPU 및 RAM 요구 사항에 맞는 VM 크기를 선택합니다. DS3 v2를 권장합니다.
+
link:task-installing-linux.html["VM 요구 사항을 검토합니다"].

** 네트워크 보안 그룹의 경우 Connector는 SSH, HTTP 및 HTTPS를 사용하는 인바운드 연결을 필요로 합니다.
+
link:reference-ports-azure.html["Connector의 보안 그룹 규칙에 대해 자세히 알아보십시오"].

** 관리 * 에서 * 켜기 * 를 선택하여 커넥터에 대해 * 시스템 할당 관리 ID * 를 활성화합니다.
+
이 설정은 커넥터 가상 시스템이 자격 증명을 제공하지 않고 Azure Active Directory에 자신을 식별할 수 있도록 관리되는 ID를 허용하므로 중요합니다. https://docs.microsoft.com/en-us/azure/active-directory/managed-identities-azure-resources/overview["Azure 리소스의 관리 ID에 대해 자세히 알아보십시오"^].



. Review + create * 페이지에서 선택 사항을 검토하고 * Create * 를 클릭하여 배포를 시작합니다.
+
Azure는 지정된 설정으로 가상 머신을 구축합니다. 가상 머신 및 커넥터 소프트웨어는 약 5분 내에 실행되어야 합니다.

. Connector 가상 머신에 연결된 호스트에서 웹 브라우저를 열고 다음 URL을 입력합니다.
+
https://_ipaddress_[]

. 로그인한 후 Connector를 설정합니다.
+
.. Connector와 연결할 NetApp 계정을 지정합니다.
+
link:concept-netapp-accounts.html["NetApp 계정 에 대해 알아보십시오"].

.. 시스템의 이름을 입력합니다.




.결과
이제 Connector가 NetApp 계정으로 설치 및 설정됩니다.

Connector가 Azure 상용 지역에 있는 경우 웹 브라우저를 열고 로 이동합니다 https://console.bluexp.netapp.com[] 을 눌러 BlueXP에서 커넥터 사용을 시작합니다.

Connector가 Azure Government 지역에 있는 경우 웹 브라우저를 열고 Connector 인스턴스의 IP 주소에 연결하여 BlueXP를 사용할 수 있습니다. https://_ipaddress_[]

Connector는 정부 지역에 배포되었기 때문에 에서 액세스할 수 없습니다 https://console.bluexp.netapp.com[].



== Azure 사용 권한 부여

Azure에서 커넥터를 배포한 경우 을 활성화해야 합니다 https://docs.microsoft.com/en-us/azure/active-directory/managed-identities-azure-resources/overview["시스템에서 할당한 관리 ID입니다"^]. 이제 사용자 지정 역할을 만든 다음 하나 이상의 구독에 대해 Connector 가상 머신에 역할을 할당하여 필요한 Azure 권한을 부여해야 합니다.

.단계
. 사용자 지정 역할 만들기:
+
.. 의 내용을 복사합니다 link:reference-permissions-azure.html["Connector에 대한 사용자 지정 역할 권한"] JSON 파일에 저장합니다.
.. 할당 가능한 범위에 Azure 구독 ID를 추가하여 JSON 파일을 수정합니다.
+
사용자가 Cloud Volumes ONTAP 시스템을 생성할 각 Azure 구독에 대한 ID를 추가해야 합니다.

+
* 예 *

+
[source, json]
----
"AssignableScopes": [
"/subscriptions/d333af45-0d07-4154-943d-c25fbzzzzzzz",
"/subscriptions/54b91999-b3e6-4599-908e-416e0zzzzzzz",
"/subscriptions/398e471c-3b42-4ae7-9b59-ce5bbzzzzzzz"
----
.. JSON 파일을 사용하여 Azure에서 사용자 지정 역할을 생성합니다.
+
다음 단계에서는 Azure Cloud Shell에서 Bash를 사용하여 역할을 생성하는 방법을 설명합니다.

+
*** 시작 https://docs.microsoft.com/en-us/azure/cloud-shell/overview["Azure 클라우드 셸"^] Bash 환경을 선택하십시오.
*** JSON 파일을 업로드합니다.
+
image:screenshot_azure_shell_upload.png["파일을 업로드하는 옵션을 선택할 수 있는 Azure Cloud Shell의 스크린 샷"]

*** Azure CLI를 사용하여 사용자 지정 역할을 생성합니다.
+
[source, azurecli]
----
az role definition create --role-definition Connector_Policy.json
----
+
이제 Connector 가상 머신에 할당할 수 있는 BlueXP Operator라는 사용자 지정 역할이 있어야 합니다.





. 하나 이상의 구독에 대해 Connector 가상 머신에 역할을 할당합니다.
+
.. Subscriptions * 서비스를 연 다음 Cloud Volumes ONTAP 시스템을 배포할 구독을 선택합니다.
.. IAM(Access Control) * > * 추가 * > * 역할 할당 추가 * 를 클릭합니다.
.. Role * 탭에서 * BlueXP Operator * 역할을 선택하고 * Next * 를 클릭합니다.
+

NOTE: BlueXP 오퍼레이터는 BlueXP 정책에 제공된 기본 이름입니다. 역할에 다른 이름을 선택한 경우 대신 해당 이름을 선택합니다.

.. Members* 탭에서 다음 단계를 완료합니다.
+
*** 관리되는 ID*에 대한 액세스를 할당합니다.
*** 구성원 선택 * 을 클릭하고 Connector 가상 머신이 생성된 구독을 선택한 다음 * 가상 머신 * 을 선택하고 Connector 가상 머신을 선택합니다.
*** 선택 * 을 클릭합니다.
*** 다음 * 을 클릭합니다.


.. 검토 + 할당 * 을 클릭합니다.
.. 추가 구독에서 Cloud Volumes ONTAP를 배포하려면 해당 구독으로 전환한 다음 이 단계를 반복합니다.




.결과
이제 Connector는 퍼블릭 클라우드 환경 내의 리소스 및 프로세스를 관리하는 데 필요한 권한을 갖습니다. BlueXP는 새로운 작업 환경을 만들 때 이 커넥터를 자동으로 사용합니다. 그러나 둘 이상의 커넥터가 있는 경우 이 작업을 수행해야 합니다 link:task-managing-connectors.html["둘 사이를 전환합니다"].

Connector를 만든 Azure 계정에 Azure Blob 저장소가 있는 경우 Canvas에 Azure Blob 작업 환경이 자동으로 표시됩니다. link:task-viewing-azure-blob.html["이 작업 환경에서 수행할 수 있는 작업에 대해 자세히 알아보십시오"].



== AutoSupport 메시지의 포트 3128을 엽니다

아웃바운드 인터넷 연결을 사용할 수 없는 서브넷에 Cloud Volumes ONTAP 시스템을 배포하려는 경우 BlueXP는 자동으로 커넥터를 프록시 서버로 사용하도록 Cloud Volumes ONTAP를 구성합니다.

유일한 요구 사항은 커넥터의 보안 그룹이 포트 3128을 통한 _IN인바운드_연결을 허용하는지 확인하는 것입니다. Connector를 배포한 후 이 포트를 열어야 합니다.

Cloud Volumes ONTAP의 기본 보안 그룹을 사용하는 경우 보안 그룹을 변경할 필요가 없습니다. 그러나 Cloud Volumes ONTAP에 대해 엄격한 아웃바운드 규칙을 정의할 계획이라면 Cloud Volumes ONTAP 보안 그룹이 포트 3128을 통한 _outbound_connection을 허용하는지 확인해야 합니다.
